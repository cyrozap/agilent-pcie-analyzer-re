# Agilent PCIe Protocol Analyzer Reverse Engineering

Reverse engineering the N5305A/N5306A family of PCIe protocol analyzers and
their host software.


## Repository contents

- [tools/agilent\_pad][rust-library]: A Rust library and tools for parsing and
  converting Agilent PAD PCIe capture files to PCAP-NG. The PCAP-NG files
  generated by the pad2pcapng tool can be dissected in Wireshark using the
  [PCIe dissector][dissector].
- [pcie-dissector][dissector]: A Wireshark dissector that can parse PCAP-NG
  files containing PCIe capture data.
- [tools/agilent\_pad.ksy][ksy]: A [Kaitai Struct][kaitai-struct] definition
  file for the Agilent PAD file format.
- [tools/cap\_tool.py][cap-tool]: A Python tool for parsing Agilent PAD PCIe
  capture files. This tool is much slower than the [Rust version][rust-library],
  and will not be developed further.


## Quick start for cap\_tool.py


### Software dependencies

* Python 3
* [Kaitai Struct Compiler][ksc]
* [Kaitai Struct Python Runtime][kspr]


### Procedure

1. Install dependencies.
2. `cd tools`
3. Run `make` to generate the parser code used by `cap_tool.py`.
4. Run `./cap_tool.py` on a `*.pad` protocol analyzer data file.


## Related projects

* [Nox][nox]: A set of FOSS tools, utilities, and libraries for PCI-Express
  analyzers.


## License

Except where otherwise noted:

* All software in this repository is made available under the
  [GNU General Public License, version 3 or later][gpl].
* All copyrightable content that is not software (e.g., reverse engineering
  notes, this README file, etc.) is licensed under the
  [Creative Commons Attribution-ShareAlike 4.0 International License][cc-by-sa].


[rust-library]: tools/agilent_pad
[dissector]: pcie-dissector
[ksy]: tools/agilent_pad.ksy
[kaitai-struct]: https://kaitai.io/
[cap-tool]: tools/cap_tool.py
[ksc]: https://github.com/kaitai-io/kaitai_struct_compiler
[kspr]: https://github.com/kaitai-io/kaitai_struct_python_runtime
[nox]: https://github.com/lethalbit/Nox
[gpl]: COPYING.txt
[cc-by-sa]: https://creativecommons.org/licenses/by-sa/4.0/
